# Подробное описание нейронной сети

## Общая структура

Архитектура нейронной сети состоит из четырех основных компонентов:

1. **Модуль временной обработки (Temporal Fusion Transformer)** - обрабатывает временные ряды данных о физиологических показателях
2. **Модуль обработки статических признаков (Static Feature Processor)** - обрабатывает профиль пользователя и калибровочные данные
3. **Модуль фузии с механизмом внимания (Attention Fusion Module)** - объединяет временные и статические признаки
4. **Многоголовый выходной модуль (Multi-head Output Module)** - генерирует различные аспекты оценки состояния

## Модуль временной обработки (Temporal Fusion Transformer)

Этот модуль предназначен для обработки временных рядов данных, получаемых от сенсоров во время тренировки. Он использует комбинацию LSTM и механизмов внимания трансформера для выявления паттернов и тенденций во временных данных.

### Архитектура:
- Две последовательные LSTM-ячейки для обработки временных последовательностей
- Механизм многоголовочного внимания для выявления важных паттернов
- Слои нормализации и регуляризации для предотвращения переобучения
- Полносвязная сеть прямого распространения (Feed Forward Network) для дополнительной обработки

### Входные данные:
- Частота сердечных сокращений (ЧСС)
- Вариабельность ЧСС (HRV)
- Скорость бега
- Каденс (шагов в минуту)
- Данные GPS (широта, долгота, высота, уклон)
- Данные акселерометра (x, y, z)

### Особенности:
- Размер окна: 30 временных точек
- Размер скрытого состояния: 64 нейрона
- Количество голов внимания: 4
- Уровень dropout: 0.2

## Модуль обработки статических признаков (Static Feature Processor)

Этот модуль обрабатывает статические данные пользователя, которые не изменяются во время тренировки, но критически важны для точной оценки состояния.

### Архитектура:
- Многослойный персептрон (MLP) с тремя скрытыми слоями
- Слои нормализации по батчам
- Функции активации ReLU
- Слои регуляризации dropout

### Входные данные:
- Демографические данные: возраст, пол, вес, рост
- Уровень физической подготовки (1-3: новичок, средний, продвинутый)
- Калибровочные данные (10 точек скорости для процентилей от 10% до 100%)

### Особенности:
- Размеры скрытых слоев: [64, 128, 64]
- Уровень dropout: 0.3
- Выходной размер: 32 признака

## Модуль фузии с механизмом внимания (Attention Fusion Module)

Этот модуль объединяет выходы временного и статического процессоров, используя механизм внимания для определения относительной важности различных признаков.

### Архитектура:
- Слой объединения признаков
- Механизм внимания для взвешивания признаков
- Слой нормализации

### Особенности:
- Входные признаки: 64 (временные) + 32 (статические) = 96
- Выходные признаки: 64
- Механизм внимания для фокусировки на наиболее значимых признаках

## Многоголовый выходной модуль (Multi-head Output Module)

Этот модуль генерирует различные аспекты оценки физиологического состояния через несколько специализированных "голов" вывода.

### Головы вывода:

1. **Голова нагрузки (Load Head)**:
   - Оценивает текущую физическую нагрузку в процентах от максимальной
   - Выход: одно значение от 0 до 1 (умножается на 100 для получения процента)
   - Функция активации: Sigmoid

2. **Голова усталости (Fatigue Head)**:
   - Классифицирует уровень усталости в одну из четырех категорий
   - Классы: низкий, средний, высокий, критический
   - Выход: вероятности для каждой категории
   - Функция активации: Softmax

3. **Голова восстановления (Recovery Head)**:
   - Оценивает уровень восстановления организма от 0 до 100%
   - Выход: одно значение от 0 до 1 (умножается на 100)
   - Функция активации: Sigmoid

4. **Голова эффективности тренировки (Effectiveness Head)**:
   - Оценивает эффективность текущей тренировки
   - Классы: недогружен, оптимально, перегружен
   - Выход: вероятности для каждой категории
   - Функция активации: Softmax

5. **Голова времени до истощения (Exhaustion Head)**:
   - Прогнозирует время до физического истощения в минутах
   - Выход: одно значение в минутах
   - Функция активации: ReLU

6. **Голова аудио-триггеров (Audio Trigger Head)**:
   - Определяет вероятность необходимости аудио-обратной связи
   - Выход: вероятность от 0 до 1
   - Функция активации: Sigmoid

7. **Голова улучшения производительности (Improvement Head)**:
   - Оценивает процент улучшения производительности
   - Выход: одно значение в процентах
   - Функция активации: ReLU

8. **Голова рекомендаций (Recommendations Head)**:
   - Генерирует признаки для создания персонализированных рекомендаций
   - Выход: вектор признаков размером 16

9. **Голова нутрицевтических признаков (Nutrition Features Head)**:
   - Генерирует признаки для модуля питания
   - Выход: вектор признаков размером 32